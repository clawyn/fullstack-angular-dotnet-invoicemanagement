<p-table
  [value]="users"
  [paginator]="true"
  [rows]="5"
  [tableStyle]="{ 'min-width': '50rem' }"
  [rowsPerPageOptions]="[5, 10, 20]"
  [totalRecords]="maxPage*size"
  [lazy]="true"
  (onLazyLoad)="loadUsers($event)"
>
  <ng-template #header>
    <tr>
      <th style="width:40%">Email</th>
      <th style="width:5%">Update</th>
      <th style="width:5%">Delete</th>
    </tr>
  </ng-template>
  <ng-template #body let-user>
    <tr>
      <td>{{ user.login }}</td>
      <td>
        @if (selectedUser === null) {
          <p-button size="small" label="Update" severity="warn" icon="pi pi-user-edit"
                    (click)="onSelectedUser(user)"></p-button>
        }
        @if (selectedUser) {
          @if (selectedUser === user) {
            <app-update-user [userEmail]="user.login" (close)="onClose()"></app-update-user>
          } @else {
            <p-button size="small" label="Update" severity="warn" icon="pi pi-user-edit"
                      (click)="onSelectedUser(user)"></p-button>
          }
        }
      </td>
      <td>
        <p-button size="small" label="Delete" severity="danger" icon="pi pi-times"
                  (click)="deleteUser(user.login)"></p-button>
      </td>
    </tr>
  </ng-template>
</p-table>
<p-button size="small" label="New user" severity="success" icon="pi pi-plus" (click)="op.toggle($event)"></p-button>
<p-popover #op>
  <app-update-user (close)="onClose()"></app-update-user>
</p-popover>
